\* TLC Model Checking Configuration for MeowEncode
\* Run with: tlc MeowEncode.tla -config MeowEncode.cfg

\* ============================================================================
\* CONSTANTS - REDUCED FOR FAST MODEL CHECKING
\* ============================================================================

\* Minimal bounds to verify core properties quickly (~1-2 minutes)
\* Increase these for deeper exploration (but much slower!)
CONSTANT MaxFrames = 2
CONSTANT MaxSessions = 1
CONSTANT MaxNonces = 3

\* Minimal password sets - still covers real/duress distinction
\* Password 1 = real, Password 2 = duress
CONSTANT Passwords = {1, 2}
CONSTANT DuressPasswords = {2}
CONSTANT RealPasswords = {1}

\* ============================================================================
\* SPECIFICATION
\* ============================================================================

SPECIFICATION Spec

\* ============================================================================
\* INVARIANTS TO CHECK
\* ============================================================================

\* Main safety invariant (combines all individual invariants)
INVARIANT Safety

\* Individual invariants for detailed debugging
INVARIANT DuressNeverOutputsReal
INVARIANT NoOutputOnAuthFailure
INVARIANT ReplayNeverSucceeds
INVARIANT TamperedFramesRejected
INVARIANT NoAuthBypass

\* ============================================================================
\* PROPERTIES TO CHECK
\* ============================================================================

\* Liveness: Eventually the decoder reaches a terminal state
\* PROPERTY EventuallyDecodes

\* ============================================================================
\* SYMMETRY (optimization - prunes equivalent states)
\* ============================================================================

\* Passwords are NOT symmetric when partitioned into Real/Duress
\* SYMMETRY PasswordSymmetry

\* ============================================================================
\* STATE CONSTRAINTS (limits exploration depth for fast checking)
\* ============================================================================

\* Limit the number of attacker actions to bound state space
CONSTRAINT AttackerActionLimit

\* ============================================================================
\* ACTION CONSTRAINTS (optional)
\* ============================================================================

\* Can force specific scenarios for targeted testing
\* ACTION_CONSTRAINT ForceAttackerAction
